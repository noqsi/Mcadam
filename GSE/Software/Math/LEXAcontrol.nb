(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47155,       1183]
NotebookOptionsPosition[     42455,       1118]
NotebookOutlinePosition[     42891,       1135]
CellTagsIndexPosition[     42848,       1132]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"enterRegister", "[", 
    RowBox[{"hex_", ",", "rw_", ",", "bits_", ",", "name_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"regHex", "[", "name", "]"}], "=", "hex"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regRW", "[", "name", "]"}], "=", "rw"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regbits", "[", "name", "]"}], "=", "bits"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.899976663201136*^9, 3.899976702286409*^9}, {
  3.899976735351595*^9, 3.8999767944967203`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e4b641ad-6640-4600-95ff-470fc8616eec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"regHex", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regRW", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regBits", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"log", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<00\>\"", ",", "\"\<rw\>\"", ",", "0", ",", "\"\<null\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<01\>\"", ",", "\"\<rw\>\"", ",", "1", ",", "\"\<MODE\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<02\>\"", ",", "\"\<rw\>\"", ",", "1", ",", "\"\<HV_CTRL\>\""}], "]"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<03\>\"", ",", "\"\<rw\>\"", ",", "16", ",", "\"\<DAC_DATA\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<04\>\"", ",", "\"\<rw\>\"", ",", "8", ",", "\"\<HSEC\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<10\>\"", ",", "\"\<rw\>\"", ",", "3", ",", 
    "\"\<FPM0_FAST_ADC_GAIN\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<11\>\"", ",", "\"\<rw\>\"", ",", "3", ",", 
    "\"\<FPM0_SLOW_ADC_GAIN\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<12\>\"", ",", "\"\<rw\>\"", ",", "16", ",", 
    "\"\<FPM0_FAST_ADC_OFFSET\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<13\>\"", ",", "\"\<rw\>\"", ",", "16", ",", 
    "\"\<FPM0_SLOW_ADC_OFFSET\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<20\>\"", ",", "\"\<rw\>\"", ",", "3", ",", 
    "\"\<FPM1_FAST_ADC_GAIN\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<21\>\"", ",", "\"\<rw\>\"", ",", "3", ",", 
    "\"\<FPM1_SLOW_ADC_GAIN\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<22\>\"", ",", "\"\<rw\>\"", ",", "16", ",", 
    "\"\<FPM1_FAST_ADC_OFFSET\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{
   "\"\<23\>\"", ",", "\"\<rw\>\"", ",", "16", ",", 
    "\"\<FPM1_SLOW_ADC_OFFSET\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<30\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<FLLD-0\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<31\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<SLLD-0\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<32\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TEMP-0\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<33\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<HOT-0\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<34\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<HVHK-0\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<35\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TIS-0\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<36\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TVS-0\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<38\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<FLLD-1\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<39\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<SLLD-1\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<3A\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TEMP-1\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<3B\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<HOT-1\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<3C\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<HVHK-1\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<3D\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TIS-1\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enterRegister", "[", 
   RowBox[{"\"\<3E\>\"", ",", "\"\<r\>\"", ",", "16", ",", "\"\<TVS-1\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.899975713324568*^9, 3.89997573222088*^9}, {
  3.8999770644175377`*^9, 3.899977079494108*^9}, {3.899987684087927*^9, 
  3.899987832997367*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"e9f1608d-78bb-41c4-8ab6-01451057e5f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hkcal", "=", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<FLLD-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FLLD-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SLLD-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SLLD-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TEMP-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"330", ",", 
          RowBox[{"-", "2100"}]}], "}"}], ",", "\"\<C\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TEMP-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"330", ",", 
          RowBox[{"-", "2100"}]}], "}"}], ",", "\"\<C\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<HOT-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"330", ",", 
          RowBox[{"-", "2100"}]}], "}"}], ",", "\"\<C\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<HOT-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"330", ",", 
          RowBox[{"-", "2100"}]}], "}"}], ",", "\"\<C\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<HVHK-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           RowBox[{"4", "/", "0.133"}]}]}], "}"}], ",", "\"\<V\>\""}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<HVHK-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           RowBox[{"4", "/", "0.133"}]}]}], "}"}], ",", "\"\<V\>\""}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TIS-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"4", "/", "0.2"}], "/", "24.7"}]}], "}"}], ",", 
        "\"\<A\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TIS-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"4", "/", "0.2"}], "/", "24.7"}]}], "}"}], ",", 
        "\"\<A\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TVS-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"4", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.806", "+", "2.490"}], ")"}], "/", "2.490"}]}]}], 
         "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TVS-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"4", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.806", "+", "2.490"}], ")"}], "/", "2.490"}]}]}], 
         "}"}], ",", "\"\<V\>\""}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.9003135982076473`*^9, 3.9003136479054937`*^9}, {
   3.900313683369731*^9, 3.900313731702668*^9}, {3.9003318640023813`*^9, 
   3.9003318952985163`*^9}, {3.900331930719873*^9, 3.900331993284781*^9}, {
   3.9003321553706017`*^9, 3.900332328169166*^9}, {3.9003323619119263`*^9, 
   3.900332390519108*^9}, {3.900332430603304*^9, 3.900332430887456*^9}, {
   3.9003324943649063`*^9, 3.900332500137043*^9}, {3.9003325631750317`*^9, 
   3.9003325750919323`*^9}, {3.900332643454777*^9, 3.9003327501268873`*^9}, {
   3.900332921832058*^9, 3.900333057591378*^9}, {3.900333448780634*^9, 
   3.900333513978538*^9}, {3.900333593407967*^9, 3.900333622999104*^9}, 
   3.9005090865277777`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"ac5d1307-15f5-425c-8801-cb6bf60473ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"adc2cal", "[", 
   RowBox[{"val_Integer", ",", 
    RowBox[{"{", 
     RowBox[{"low_", ",", "high_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"signed16", "[", "val", "]"}], "+", "32768."}], ")"}], "/", 
     "65536."}], 
    RowBox[{"(", 
     RowBox[{"high", "-", "low"}], ")"}]}], "+", "low"}]}]], "Input",
 CellChangeTimes->{{3.900509183495575*^9, 3.900509198082378*^9}, {
  3.90050955694471*^9, 3.900509573690508*^9}, {3.9005096182484903`*^9, 
  3.90050967059921*^9}, {3.900509720270056*^9, 3.9005098065057087`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f41ad1f1-f66b-42e5-b03d-a99ac6a4174c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"adc2cal", "[", 
   RowBox[{"\"\<N/A\>\"", ",", "_"}], "]"}], ":=", "\"\<N/A\>\""}]], "Input",
 CellChangeTimes->{{3.900510047795096*^9, 3.900510080565671*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"1b1b87d0-a40b-46e8-a6fb-75aa20ceb8aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hk2cal", "[", "chan_String", "]"}], ":=", 
  RowBox[{"adc2cal", "[", 
   RowBox[{
    RowBox[{"cachedRegister", "[", "chan", "]"}], ",", 
    RowBox[{
     RowBox[{"hkcal", "[", "chan", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.900509914725679*^9, 3.9005100071318693`*^9}, {
  3.90051010684107*^9, 3.900510140541801*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8f114da2-5bbc-4f0d-93ba-97233e8360c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dacal", "=", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<FLLD-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FLLD-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SLLD-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SLLD-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}], ",", "\"\<V\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<HVDAC-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           RowBox[{"4", "/", "0.133"}]}]}], "}"}], ",", "\"\<V\>\""}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<HVDAC-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           RowBox[{"4", "/", "0.133"}]}]}], "}"}], ",", "\"\<V\>\""}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TDAC-0\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"4", "/", "0.2"}], "/", "24.7"}]}], "}"}], ",", 
        "\"\<A\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TDAC-1\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"4", "/", "0.2"}], "/", "24.7"}]}], "}"}], ",", 
        "\"\<A\>\""}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.90034505644366*^9, 3.900345067815184*^9}, {
   3.9003451158715982`*^9, 3.9003451780478363`*^9}, {3.90034540481159*^9, 
   3.900345413626389*^9}, {3.900345449081567*^9, 3.900345460668373*^9}, {
   3.90034568675733*^9, 3.9003457102451887`*^9}, {3.900345750236225*^9, 
   3.9003457780930643`*^9}, 3.900509094552087*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"b758fcae-019a-4025-99f4-c86e0bd7973a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPGAregs", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "regRW", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<rw\>\""}], "&"}]}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HKchannels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "regRW", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<r\>\""}], "&"}]}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hkcalUnits", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hkcal", "[", "#", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "HKchannels"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.900153998302825*^9, 3.900154073464904*^9}, 
   3.900513883411199*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"db9d2bf5-dafd-4e2c-b724-4c4cac234a54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"startGSE", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gse", "=", 
     RowBox[{"StartProcess", "[", "\"\<lexagse\>\"", "]"}]}], ";", 
    RowBox[{"untilDone", "[", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.899987120710608*^9, 3.8999871466379747`*^9}, 
   3.899988183665386*^9, {3.900063765673974*^9, 3.900063767129033*^9}, {
   3.900173929490411*^9, 3.90017394979536*^9}, {3.9005220020080223`*^9, 
   3.900522031240464*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"27f605d0-a74c-4b0e-9f16-3c6d6642680b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stopGSE", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rawCommand", "[", "\"\<exit\>\"", "]"}], ";", 
    RowBox[{"gse", "=", "Null"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.900063956612722*^9, 3.900063982281643*^9}, {
   3.900173878659745*^9, 3.900173879297826*^9}, 3.900174358345893*^9, {
   3.900174453574587*^9, 3.900174454278591*^9}, {3.900174587377037*^9, 
   3.9001746107321978`*^9}, {3.900522119556797*^9, 3.900522134385417*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"92843710-6778-4385-83ad-9e22a8d6cbb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawCommand", "[", "cmd_String", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteLine", "[", 
     RowBox[{"gse", ",", "cmd"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"untilDone", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.899978346483901*^9, 3.89997836750146*^9}, {
   3.899978461787909*^9, 3.899978479320402*^9}, {3.899980003187747*^9, 
   3.899980004588005*^9}, {3.8999856226103897`*^9, 3.899985684231686*^9}, {
   3.8999857163601713`*^9, 3.899985744414706*^9}, {3.899986941033924*^9, 
   3.899987016111499*^9}, 3.899987864440094*^9, {3.900411802017549*^9, 
   3.900411858566065*^9}, {3.900411999759872*^9, 3.900412026863884*^9}, {
   3.900412081962489*^9, 3.900412083042284*^9}, {3.900413916535346*^9, 
   3.9004139204482203`*^9}, {3.9004139964515753`*^9, 3.900414002094529*^9}, {
   3.900414067392995*^9, 3.900414073126964*^9}, {3.900414216551406*^9, 
   3.900414235703925*^9}, {3.900521947425508*^9, 3.900521986980249*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"4bd36f92-1ea9-41c5-8e23-cc7d5d06af98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"untilDone", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"done", "=", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"!", "done"}], ",", 
      RowBox[{"processResponses", "[", 
       RowBox[{"ReadString", "[", 
        RowBox[{"gse", ",", "EndOfBuffer"}], "]"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.90052190043251*^9, 3.90052195020094*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"18cbb594-4532-49af-a8ab-7ef33e295110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"processResponses", "[", "s_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", "=", 
      RowBox[{"ImportString", "[", 
       RowBox[{"s", ",", "\"\<TSV\>\""}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toLog", "[", "s", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scan", "[", 
      RowBox[{"response", ",", "r"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.899988144019072*^9, 3.899988160373415*^9}, {
  3.9000844447509117`*^9, 3.900084458680244*^9}, {3.900084853621228*^9, 
  3.9000848685015097`*^9}, {3.900084909802763*^9, 3.900085022082233*^9}, {
  3.9000874834163923`*^9, 3.900087548295467*^9}, {3.900087763725947*^9, 
  3.9000878017524023`*^9}, {3.900522508337595*^9, 3.900522516587737*^9}, {
  3.900522664836849*^9, 3.9005227212481537`*^9}, {3.900523319981036*^9, 
  3.900523325189478*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"ec58ca09-b59f-4f18-9942-ba2132239018"],

Cell[BoxData[
 RowBox[{
  RowBox[{"response", "[", 
   RowBox[{"{", "\"\<done\>\"", "}"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"done", "=", "True"}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.900411886601569*^9, 3.9004119368956738`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"0d417c65-1a8d-4358-b54f-3ad8b3728e80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"response", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", "\"\<current_adr\>\"", ",", "wa_", ",", "ra_"}], "}"}],
    "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shadowWriteAddr", "=", "wa"}], ";", "\[IndentingNewLine]", 
    RowBox[{"shadowReadAddr", "=", "ra"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.900087149400058*^9, 3.9000872238116007`*^9}, {
   3.9000873151116056`*^9, 3.900087425118657*^9}, 3.900087607648694*^9, {
   3.9000882088139267`*^9, 3.900088215028908*^9}, {3.900097073250238*^9, 
   3.900097093146566*^9}, {3.900154851220978*^9, 3.900154864181445*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"ded5d7ff-0ebf-459e-ac76-79bb6fab9e5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"response", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", "\"\<data_out\>\"", ",", "d_"}], "}"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lastDataOut", "=", "d"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.900087149400058*^9, 3.9000872238116007`*^9}, {
   3.9000873151116056`*^9, 3.900087425118657*^9}, 3.900087607648694*^9, {
   3.9000882088139267`*^9, 3.900088215028908*^9}, {3.9000932916226397`*^9, 
   3.900093354611964*^9}, {3.900097040629311*^9, 3.900097052108906*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"7ef29023-2022-4af5-8fbe-e73bca52064f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"response", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", "\"\<data_in\>\"", ",", "d_"}], "}"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lastDataIn", "=", "d"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.900087149400058*^9, 3.9000872238116007`*^9}, {
   3.9000873151116056`*^9, 3.900087425118657*^9}, 3.900087607648694*^9, {
   3.9000882088139267`*^9, 3.900088215028908*^9}, {3.9000932916226397`*^9, 
   3.900093400018508*^9}, {3.900097058728261*^9, 3.900097066799026*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"e665a488-f3ac-4df9-bda9-3bfc1e3b9f25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rawXadr", "[", 
   RowBox[{"w_String", ",", "r_String"}], "]"}], ":=", 
  RowBox[{"rawCommand", "[", 
   RowBox[{"\"\<xadr \>\"", "<>", "w", "<>", "\"\< \>\"", "<>", "r"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawXdata", "[", "d_Integer", "]"}], ":=", 
  RowBox[{"rawCommand", "[", 
   RowBox[{"\"\<xdata \>\"", "<>", 
    RowBox[{"ToString", "[", "d", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8999883475382757`*^9, 3.899988452345017*^9}, {
  3.899996632816135*^9, 3.899996670440672*^9}, {3.899996870140111*^9, 
  3.899996917459208*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"fd216a1a-e174-4db8-a7ab-216f0847904e"],

Cell["\<\
Usually, we\[CloseCurlyQuote]ll either read or write data, but not plan both \
at once. \
\>", "Text",
 CellChangeTimes->{{3.9000024477961817`*^9, 3.900002502023959*^9}, {
  3.900004697844273*^9, 
  3.900004699018034*^9}},ExpressionUUID->"1e40a1cf-a670-471f-8511-\
e7a21682c41e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"readAdr", "[", "adr_String", "]"}], ":=", 
  RowBox[{"rawXadr", "[", 
   RowBox[{"\"\<00\>\"", ",", 
    RowBox[{"regHex", "[", "adr", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writeAdr", "[", "adr_String", "]"}], ":=", 
  RowBox[{"rawXadr", "[", 
   RowBox[{
    RowBox[{"regHex", "[", "adr", "]"}], ",", "\"\<00\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.900002254546421*^9, 3.9000024055490294`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"2e630c41-c96b-48d4-9503-3ef8d2e5bdec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dacNumbers", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<FLLD-0\>\"", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<HVDAC-0\>\"", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<SLLD-0\>\"", "]"}], "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<TDAC-0\>\"", "]"}], "=", "3"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<FLLD-1\>\"", "]"}], "=", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<HVDAC-1\>\"", "]"}], "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<SLLD-1\>\"", "]"}], "=", "6"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dacNumbers", "[", "\"\<TDAC-1\>\"", "]"}], "=", "7"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.900001563802374*^9, 3.9000018080143137`*^9}, {
  3.90001457405017*^9, 3.9000145761126223`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"ca5be524-a190-4f1c-894c-d5a3bc6c0c1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setDACuncalibrated", "[", 
   RowBox[{"dac_String", ",", 
    RowBox[{"val_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dacVal", "=", 
      RowBox[{"Clip", "[", 
       RowBox[{
        RowBox[{"Round", "[", "val", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "4095"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"writeAdr", "[", "\"\<DAC_DATA\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rawXdata", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dacNumbers", "[", "dac", "]"}], "*", "4096"}], "+", 
       "dacVal"}], "]"}], ";", "\[IndentingNewLine]", "dacVal"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.900001894615492*^9, 3.900001982932764*^9}, {
  3.9000144307610607`*^9, 3.900014455863233*^9}, {3.900014499786888*^9, 
  3.900014535583637*^9}, {3.900014586052752*^9, 3.9000146237009993`*^9}, {
  3.900014680799046*^9, 3.900014744146305*^9}, {3.900014778543171*^9, 
  3.900014825517174*^9}, {3.900517043202993*^9, 3.900517231762887*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"0733ecf7-aa55-4558-a27f-7dd108ac073d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"readRegister", "[", "reg_String", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"readAdr", "[", "reg", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rawXdata", "[", "0", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cachedRegister", "[", "reg", "]"}], "=", "lastDataIn"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.9000938917399817`*^9, 3.900094075059462*^9}, {
  3.900094181114254*^9, 3.900094193443576*^9}, {3.900096158999338*^9, 
  3.9000962819023247`*^9}, {3.900096693735779*^9, 3.90009670930967*^9}, {
  3.900097111832602*^9, 3.900097120135268*^9}, {3.900153392366848*^9, 
  3.9001534655584106`*^9}, {3.90015866432231*^9, 3.900158697564499*^9}, {
  3.900168092599765*^9, 3.900168110216613*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"4b282642-d34f-4d2c-bf54-72055709b5b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"signed16", "[", "n_Integer", "]"}], ":=", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"n", "+", "32768"}], ",", "65536"}], "]"}], "-", 
   "32768"}]}]], "Input",
 CellChangeTimes->{{3.900159986072584*^9, 3.9001600427545137`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"7b74eb15-cc08-4785-9e4f-c853a1a79dc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"signed16", "[", "t_String", "]"}], ":=", "t"}]], "Input",
 CellChangeTimes->{{3.90016147403679*^9, 3.900161498925796*^9}, {
  3.90016154220399*^9, 3.9001615640708513`*^9}, {3.900161635786524*^9, 
  3.900161658707596*^9}, {3.900261478588315*^9, 3.9002614825766983`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"fc2696b1-8fb8-4c85-8b02-8e4e2b877cbe"],

Cell["Abbrevs", "Text",
 CellChangeTimes->{{3.900063068115933*^9, 
  3.900063073233418*^9}},ExpressionUUID->"0f9366f6-3957-4407-94b8-\
df40164dfcb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rc", "=", "rawCommand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxa", "=", "rawXadr"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxd", "=", "rawXdata"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ra", "=", "readAdr"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wa", "=", "writeAdr"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sdu", "=", "setDACuncalibrated"}], ";"}]}], "Input",
 CellChangeTimes->{{3.900063091670439*^9, 3.9000631353399982`*^9}, 
   3.900063265089037*^9, {3.900063323043476*^9, 3.900063364212248*^9}, {
   3.900065223184977*^9, 3.9000652455870333`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"17fac4b0-2c3f-4edb-a7f5-02d90d66972e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"log", "=", 
   RowBox[{"CreateDocument", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"WindowTitle", "\[Rule]", "\"\<Log\>\""}], ",", 
     RowBox[{"WindowElements", "\[Rule]", 
      RowBox[{"{", "\"\<VerticalScrollBar\>\"", "}"}]}], ",", 
     RowBox[{"WindowFrame", "\[Rule]", "\"\<ModelessDialog\>\""}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"log", "=", "Null"}], ")"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.900084140948997*^9, 3.900084203104353*^9}, 
   3.900084376918895*^9, {3.900267164943757*^9, 3.900267169549686*^9}, {
   3.9002672631149197`*^9, 3.9002672654957533`*^9}, 3.900267792631803*^9, {
   3.9002678321069727`*^9, 3.900267908119814*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"170b3ef6-57f6-4afd-80d5-110354b9b32b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"toLog", "[", "\"\<\>\"", "]"}], ":=", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toLog", "[", "s_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"NotebookWrite", "[", 
    RowBox[{"log", ",", 
     RowBox[{"Cell", "[", 
      RowBox[{"s", ",", "\"\<Output\>\""}], "]"}]}], "]"}], "/;", 
   RowBox[{"UnsameQ", "[", 
    RowBox[{"log", ",", "Null"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.900084263647849*^9, 3.9000843259191008`*^9}, {
   3.900084371348153*^9, 3.9000843930476313`*^9}, 3.900084662964633*^9, {
   3.900267955013384*^9, 3.900267976197147*^9}, {3.900411617798252*^9, 
   3.900411636569087*^9}, {3.900523796255556*^9, 3.900523815381583*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"10fb33e8-4e8f-4e91-85ca-40e2ec857fc6"],

Cell[CellGroupData[{

Cell["Control Panel", "Subsection",
 CellChangeTimes->{{3.900432280827589*^9, 
  3.900432285739975*^9}},ExpressionUUID->"cb143c65-ca45-45b7-b2e6-\
558e3cbd7b6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gseSetter", "=", 
   RowBox[{"SetterBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{"connectState", ",", "connectAction"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Connected\>\"", ",", "\"\<Disconnected\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectState", "=", "\"\<Disconnected\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"connectAction", "[", 
   RowBox[{"\"\<Disconnected\>\"", ",", "_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"stopGSE", "[", "]"}], ";", 
    RowBox[{"connectState", "=", "\"\<Disconnected\>\""}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectAction", "[", 
   RowBox[{"\"\<Connected\>\"", ",", "_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"startGSE", "[", "]"}], ";", 
    RowBox[{"connectState", "=", "\"\<Connected\>\""}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.900432401175747*^9, 3.9004324069693317`*^9}, {
   3.9004324667025347`*^9, 3.9004324675098963`*^9}, 3.90043257515996*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"0dd1bf4d-e36a-44e9-876d-dc70d53a6097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"interfaceSetter", "=", 
   RowBox[{"SetterBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{"enableState", ",", "enableAction"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Enabled\>\"", ",", "\"\<Disabled\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enableState", "=", "\"\<Disabled\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enableAction", "[", 
   RowBox[{"\"\<Disabled\>\"", ",", "_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rawCommand", "[", "\"\<disable\>\"", "]"}], ";", 
    RowBox[{"enableState", "=", "\"\<Disabled\>\""}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enableAction", "[", 
   RowBox[{"\"\<Enabled\>\"", ",", "_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rawCommand", "[", "\"\<enable\>\"", "]"}], ";", 
    RowBox[{"enableState", "=", "\"\<Enabled\>\""}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.90043409641182*^9, 3.9004341128614597`*^9}, 
   3.9004341643193207`*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"71139fd6-47d3-4c16-8a61-621a1d6d3974"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hkTable", "=", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Housekeeping  \>\"", ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Refresh\>\"", ",", 
            RowBox[{"updateHKDataTable", "[", "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Spacer", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "13"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "[", "hkDataTable", "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"BaselinePosition", "->", "Top"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"updateHKDataTable", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Scan", "[", 
      RowBox[{"readRegister", ",", "HKchannels"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"makeHKDataTable", "[", "]"}], ";"}], "\[IndentingNewLine]", 
    ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeHKDataTable", "[", "]"}], ":=", 
  RowBox[{"hkDataTable", "=", " ", 
   RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"HKchannels", ",", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"signed16", "[", 
            RowBox[{"cachedRegister", "[", "#", "]"}], "]"}], "&"}], ",", 
          "HKchannels"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"hk2cal", "/@", "HKchannels"}], ",", "\[IndentingNewLine]", 
        "hkcalUnits"}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TableSpacing", "->", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9004343689193087`*^9, 3.900434388389324*^9}, {
   3.900434488810255*^9, 3.900434503146697*^9}, {3.9004345516087427`*^9, 
   3.900434597366008*^9}, {3.900434642207347*^9, 3.900434726574936*^9}, {
   3.900434762461972*^9, 3.900434791254838*^9}, {3.9004348833789377`*^9, 
   3.900434986136725*^9}, {3.9004352499268723`*^9, 3.900435254694656*^9}, {
   3.900436210926732*^9, 3.9004362188634644`*^9}, {3.9005081487860937`*^9, 
   3.900508214706717*^9}, {3.900511193709621*^9, 3.900511201421262*^9}, {
   3.900511235682107*^9, 3.900511299186922*^9}, 3.90051135022493*^9, 
   3.900530213501275*^9, 3.900530256678918*^9, {3.90053115817481*^9, 
   3.900531188332293*^9}, {3.9005312985598907`*^9, 3.900531299249071*^9}, {
   3.900531413606799*^9, 3.900531415773954*^9}, {3.900531446830249*^9, 
   3.900531447410207*^9}, {3.9005315318116217`*^9, 3.900531532809499*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"44f42b94-194a-489b-a9ab-262b0f4e0f3f"],

Cell[CellGroupData[{

Cell["Register controls", "Subsubsection",
 CellChangeTimes->{{3.900530291728088*^9, 
  3.900530301201384*^9}},ExpressionUUID->"160bdc94-5c3a-4723-8db0-\
0847b9796ee6"],

Cell["Function constructor for setter in a Dynamic construct.", "Text",
 CellChangeTimes->{{3.9005303494395037`*^9, 
  3.9005303882011003`*^9}},ExpressionUUID->"c168f23f-48ad-46be-8566-\
d66633d26ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alterReg", "[", "reg_String", "]"}], "[", 
   RowBox[{"val_", ",", "_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"writeAdr", "[", "reg", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rawXdata", "[", 
     RowBox[{"Round", "[", "val", "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"readRegister", "[", "reg", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.9005288299028273`*^9, 3.900528836289783*^9}, {
  3.9005288664452057`*^9, 3.900528898613925*^9}, {3.9005289487467613`*^9, 
  3.900528980818872*^9}, {3.9005290255468807`*^9, 3.9005290800607243`*^9}, {
  3.9005291586708593`*^9, 3.900529211422297*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"e6885a7a-321d-46c0-8a4b-3a86fdbd2fab"],

Cell["Input field constructor.", "Text",
 CellChangeTimes->{{3.9005304498435307`*^9, 
  3.900530459652102*^9}},ExpressionUUID->"d8942796-5f8f-405e-9217-\
413788f9d07a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"regField", "[", "reg_String", "]"}], ":=", 
  RowBox[{"InputField", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", 
     RowBox[{
      RowBox[{"signed16", "[", 
       RowBox[{"cachedRegister", "[", "reg", "]"}], "]"}], ",", 
      RowBox[{"alterReg", "[", "reg", "]"}]}], "]"}], ",", "Number", ",", 
    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9005323979402943`*^9, 3.900532399450433*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"4908c9c6-2d50-49ce-b693-4707f969a5a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"registerTable", "=", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<FPGA Registers  \>\"", ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Refresh\>\"", ",", 
            RowBox[{"updateRegisterDataTable", "[", "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Spacer", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"FPGAregs", ",", 
           RowBox[{"regField", "/@", "FPGAregs"}]}], "}"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", " ", 
     RowBox[{"BaselinePosition", "->", "Top"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"updateRegisterDataTable", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Scan", "[", 
     RowBox[{"readRegister", ",", "FPGAregs"}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{{3.9004343689193087`*^9, 3.900434388389324*^9}, {
  3.900434488810255*^9, 3.900434503146697*^9}, {3.9004345516087427`*^9, 
  3.900434597366008*^9}, {3.900434642207347*^9, 3.900434726574936*^9}, {
  3.900434762461972*^9, 3.900434791254838*^9}, {3.9004348833789377`*^9, 
  3.900434986136725*^9}, {3.9004352499268723`*^9, 3.900435254694656*^9}, {
  3.9004354852791224`*^9, 3.900435668607777*^9}, {3.9004357816211777`*^9, 
  3.9004357822027073`*^9}, {3.900436169851478*^9, 3.900436187769843*^9}, {
  3.900508233917993*^9, 3.900508296813595*^9}, {3.9005305256833773`*^9, 
  3.90053056538278*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"56fd3f0a-5224-40b9-a80d-9111c8905f64"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup the panel.", "Subsubsection",
 CellChangeTimes->{{3.900530746947764*^9, 
  3.9005307557109137`*^9}},ExpressionUUID->"eef4020a-4fc1-4ff8-a95a-\
c6dda00b1398"],

Cell["Initialize the cache.", "Text",
 CellChangeTimes->{{3.90050783100316*^9, 
  3.900507851254754*^9}},ExpressionUUID->"206b16f5-0c69-4e9e-ac6f-\
7bc6a904730e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scan", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"cachedRegister", "[", "#", "]"}], "=", "\"\<N/A\>\""}], ")"}],
      "&"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"HKchannels", ",", "FPGAregs"}], "]"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{3.9005078580863323`*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"95ca4cc4-f62c-462a-a91e-85ee8bae3514"],

Cell["Initialize the dynamic tables.", "Text",
 CellChangeTimes->{{3.9005083192029552`*^9, 3.9005083440933437`*^9}, {
  3.9005306279502277`*^9, 3.900530630186808*^9}, {3.900530699456394*^9, 
  3.90053070571603*^9}},ExpressionUUID->"4e4cf8c1-f084-4b9d-92e1-\
541ae6e88e75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeHKDataTable", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.900508356878528*^9, 3.9005084145904627`*^9}, {
  3.900530623044292*^9, 3.900530623843617*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"d3a33925-9035-4b89-a999-502cd677c946"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateDialog", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<GSE:  \>\"", ",", "gseSetter", ",", 
         "\"\<       Interface:  \>\"", ",", "interfaceSetter"}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"hkTable", ",", 
         RowBox[{"Spacer", "[", "60", "]"}], ",", "registerTable"}], "}"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"WindowTitle", "\[Rule]", "\"\<LEXA Control Panel\>\""}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.900431697635787*^9, 3.900431875871694*^9}, {
   3.900431922944545*^9, 3.900431935188675*^9}, {3.900431976587057*^9, 
   3.9004320355592957`*^9}, {3.9004321027365227`*^9, 
   3.9004321217376013`*^9}, {3.900433798664784*^9, 3.900433806585249*^9}, {
   3.900433898408255*^9, 3.900433904079121*^9}, {3.900436599621044*^9, 
   3.9004366009040318`*^9}, 3.900508479536593*^9, {3.900533141929706*^9, 
   3.90053315131732*^9}, {3.900533183534655*^9, 3.9005331841661463`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"5ebe407d-dd3b-4f49-94c9-62953fee1d36"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{798, 555},
WindowMargins->{{78.6, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2c0b814e-1d2a-4f16-9227-9e9d94769e90"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 757, 18, 131, "Input",ExpressionUUID->"e4b641ad-6640-4600-95ff-470fc8616eec"],
Cell[1318, 40, 4750, 134, 637, "Input",ExpressionUUID->"e9f1608d-78bb-41c4-8ab6-01451057e5f5"],
Cell[6071, 176, 4468, 122, 342, "Input",ExpressionUUID->"ac5d1307-15f5-425c-8801-cb6bf60473ea"],
Cell[10542, 300, 703, 18, 32, "Input",ExpressionUUID->"f41ad1f1-f66b-42e5-b03d-a99ac6a4174c"],
Cell[11248, 320, 273, 5, 29, "Input",ExpressionUUID->"1b1b87d0-a40b-46e8-a6fb-75aa20ceb8aa"],
Cell[11524, 327, 486, 11, 29, "Input",ExpressionUUID->"8f114da2-5bbc-4f0d-93ba-97233e8360c7"],
Cell[12013, 340, 2505, 69, 212, "Input",ExpressionUUID->"b758fcae-019a-4025-99f4-c86e0bd7973a"],
Cell[14521, 411, 1197, 39, 70, "Input",ExpressionUUID->"db9d2bf5-dafd-4e2c-b724-4c4cac234a54"],
Cell[15721, 452, 563, 12, 29, "Input",ExpressionUUID->"27f605d0-a74c-4b0e-9f16-3c6d6642680b"],
Cell[16287, 466, 571, 11, 29, "Input",ExpressionUUID->"92843710-6778-4385-83ad-9e22a8d6cbb6"],
Cell[16861, 479, 1130, 19, 90, "Input",ExpressionUUID->"4bd36f92-1ea9-41c5-8e23-cc7d5d06af98"],
Cell[17994, 500, 596, 14, 90, "Input",ExpressionUUID->"18cbb594-4532-49af-a8ab-7ef33e295110"],
Cell[18593, 516, 1056, 22, 111, "Input",ExpressionUUID->"ec58ca09-b59f-4f18-9942-ba2132239018"],
Cell[19652, 540, 340, 8, 29, "Input",ExpressionUUID->"0d417c65-1a8d-4358-b54f-3ad8b3728e80"],
Cell[19995, 550, 754, 15, 90, "Input",ExpressionUUID->"ded5d7ff-0ebf-459e-ac76-79bb6fab9e5b"],
Cell[20752, 567, 659, 13, 70, "Input",ExpressionUUID->"7ef29023-2022-4af5-8fbe-e73bca52064f"],
Cell[21414, 582, 657, 13, 70, "Input",ExpressionUUID->"e665a488-f3ac-4df9-bda9-3bfc1e3b9f25"],
Cell[22074, 597, 683, 15, 56, "Input",ExpressionUUID->"fd216a1a-e174-4db8-a7ab-216f0847904e"],
Cell[22760, 614, 289, 7, 35, "Text",ExpressionUUID->"1e40a1cf-a670-471f-8511-e7a21682c41e"],
Cell[23052, 623, 549, 13, 50, "Input",ExpressionUUID->"2e630c41-c96b-48d4-9503-3ef8d2e5bdec"],
Cell[23604, 638, 1274, 38, 192, "Input",ExpressionUUID->"ca5be524-a190-4f1c-894c-d5a3bc6c0c1f"],
Cell[24881, 678, 1252, 29, 131, "Input",ExpressionUUID->"0733ecf7-aa55-4558-a27f-7dd108ac073d"],
Cell[26136, 709, 892, 16, 111, "Input",ExpressionUUID->"4b282642-d34f-4d2c-bf54-72055709b5b6"],
Cell[27031, 727, 361, 9, 29, "Input",ExpressionUUID->"7b74eb15-cc08-4785-9e4f-c853a1a79dc4"],
Cell[27395, 738, 383, 6, 29, "Input",ExpressionUUID->"fc2696b1-8fb8-4c85-8b02-8e4e2b877cbe"],
Cell[27781, 746, 149, 3, 35, "Text",ExpressionUUID->"0f9366f6-3957-4407-94b8-df40164dfcb0"],
Cell[27933, 751, 741, 16, 131, "Input",ExpressionUUID->"17fac4b0-2c3f-4edb-a7f5-02d90d66972e"],
Cell[28677, 769, 947, 20, 50, "Input",ExpressionUUID->"170b3ef6-57f6-4afd-80d5-110354b9b32b"],
Cell[29627, 791, 804, 18, 50, "Input",ExpressionUUID->"10fb33e8-4e8f-4e91-85ca-40e2ec857fc6"],
Cell[CellGroupData[{
Cell[30456, 813, 161, 3, 54, "Subsection",ExpressionUUID->"cb143c65-ca45-45b7-b2e6-558e3cbd7b6d"],
Cell[30620, 818, 1155, 29, 131, "Input",ExpressionUUID->"0dd1bf4d-e36a-44e9-876d-dc70d53a6097"],
Cell[31778, 849, 1124, 29, 131, "Input",ExpressionUUID->"71139fd6-47d3-4c16-8a61-621a1d6d3974"],
Cell[32905, 880, 3030, 66, 402, "Input",ExpressionUUID->"44f42b94-194a-489b-a9ab-262b0f4e0f3f"],
Cell[CellGroupData[{
Cell[35960, 950, 168, 3, 45, "Subsubsection",ExpressionUUID->"160bdc94-5c3a-4723-8db0-0847b9796ee6"],
Cell[36131, 955, 201, 3, 35, "Text",ExpressionUUID->"c168f23f-48ad-46be-8566-d66633d26ec5"],
Cell[36335, 960, 818, 17, 111, "Input",ExpressionUUID->"e6885a7a-321d-46c0-8a4b-3a86fdbd2fab"],
Cell[37156, 979, 168, 3, 35, "Text",ExpressionUUID->"d8942796-5f8f-405e-9217-413788f9d07a"],
Cell[37327, 984, 545, 13, 50, "Input",ExpressionUUID->"4908c9c6-2d50-49ce-b693-4707f969a5a5"],
Cell[37875, 999, 1943, 43, 201, "Input",ExpressionUUID->"56fd3f0a-5224-40b9-a80d-9111c8905f64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39855, 1047, 169, 3, 45, "Subsubsection",ExpressionUUID->"eef4020a-4fc1-4ff8-a95a-c6dda00b1398"],
Cell[40027, 1052, 162, 3, 35, "Text",ExpressionUUID->"206b16f5-0c69-4e9e-ac6f-7bc6a904730e"],
Cell[40192, 1057, 438, 14, 29, "Input",ExpressionUUID->"95ca4cc4-f62c-462a-a91e-85ee8bae3514"],
Cell[40633, 1073, 272, 4, 35, "Text",ExpressionUUID->"4e4cf8c1-f084-4b9d-92e1-541ae6e88e75"],
Cell[40908, 1079, 281, 6, 29, "Input",ExpressionUUID->"d3a33925-9035-4b89-a999-502cd677c946"],
Cell[41192, 1087, 1235, 27, 127, "Input",ExpressionUUID->"5ebe407d-dd3b-4f49-94c9-62953fee1d36"]
}, Open  ]]
}, Open  ]]
}
]
*)

